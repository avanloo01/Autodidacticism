# tmp-file

- VB-script
- save copy as cleaned
- decode base64
    - useless
- rename variables
- look at function
    - gets every third character
    - extracts from large string
- first string = file system
- bypass powershell execution
    - runs ps script

# ps script

- cleaned copy
- many try-catch statements
- beautify
- weird variable is just "powershell"
- bad powershell code to obfuscate
- more bad code in .ini files
- bad code in try statements
    - good in catch
- secure string
- executes code iex from desktop.ini
- finalstring was just "
    - does work in windows

# Finally powershell code

- remove useless strings
- rename variables
- looks at other files
- ping.ini
- ifn= get-random: random process
- creates a .temp file using random process
- doesn't show windows
    - stay hidden

## citadel function

- arguments
- grabs length of .ps1 & .tmp

## sleep function

## Info

- about host
- mac address

## /reset

- bitsadmin
- argument deletes all jobs


## slmgr.ini

- domains


## MrPoop

- random eight char variable
- puts in .log file
- bitsadmin to transfer:q
    - random chars is jobname

## cryptokey

- comes from domains

## Enumeration techniques

- fmail variable
- looks for Outlook
- lists information


## EvilRick

- gets length of scripts & uses weird variable first script

## Final

- encodes everything base64
    - transfer to domain
- cleans up bitsadmin jobs

# urls

- domains are unaccessible
- showdan shows ips exist
- both hosts from same ip
- virustotal shows it's malware
